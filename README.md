# Read Team Pentesting Methodology | CheatSheet
## nmap
```bash
$ nmap -p- -Pn -T4 -v <ip> -oN all_ports
$ nmap -p <ports> -Pn -T4 -sC -sV <ip>-oN normal
$ nmap -p- -Pn -T4 <ip> --script vuln -oN vuln-script
$ nmap -sU -T4 <ip> -oN udp-scan
```
## dns
```bash
$ dig ax domain.com @<ip>
$ dig mx domain.com @<ip>
$ dig axfr domain.com @<ip>
```
## rpc

```bash
$ rpcclient -N -U '' <ip>
```
## smb
```bash
$ smbclient -L //<ip>/
$ nxc smb <ip> -u '' -p ''
$ nxc smb <ip> -u '' -p '' --users --shares --rid-brute --lsa --sam --ntds -X 'whoami' -spider
$ nxc smb <ip> -u '' -p '' --pass-pol --no-bruteforce --continue-on-succes
$ sudo mount -t cifs -o 'username=user,password=' //<ip>/share /mnt
```
## ftp
```bash
$ ftp user@<ip>
$ nxc ftp <ip> -u '' -p '' --ls --get file.txt --put file.txt
```
## nfs
```bash
$ sudo nmap -sV --script rpcinfo 10.10.13.37 -p111
$ sudo nmap -sV --script 'nfs*' 10.10.13.37 -p2049
$ showmount -e <ip>
$ sudo mount -v -t nfs -o vers=3 -o nolock -o user=username,pass='Pass' <ip>:/home /mnt/nfs
```
## ldap
```bash
$ ldeep ldap -a -d domain.com -s ldap://domain.com:389 users -v
$ ldeep ldap -a -d domain.com -s ldap://domain.com:389 computers -v
$ ldeep ldap -a -d domain.com -s ldap://domain.com:389 all -v
$ nxc ldap <ip> -u '' -p '' --bloodhound --users --groups --dc-list --get-sid 
```
## Kerberos
```bash
$ kerbrute userenum --dc <ip> -d domain.com /opt/SecLists/Usernames/xato-net-10-million-usernames.txt
$ kerbrute passwordspray --dc <ip> -d domain.com /opt/SecLists/Usernames/xato-net-10-million-usernames.txt Password!
$ GetNPUsers.py DOMAIN.COM/User:password -dc-ip ip -dc-host domain.com -no-pass -k -hashes -request -usersfile users.txt -output output.txt
$ GetUserSPNs.py DOMAIN.COM/User:password -dc-ip ip -dc-host domain.com -no-pass -k -hashes -request -usersfile users.txt -output output.txt
$ nxc ldap <ip> -u '' -p '' --asreproast --kerberoasting 
```
## UDP
```bash
$ snmp-check <ip>
$ snmp-check -v 2c -c public <ip>
$ onesixtyone -c /usr/share/seclists/Discovery/SNMP/snmp.txt 10.10.13.37
$ nmap --script "snmp* and not snmp-brute" <target>
$ snmpbulkwalk -c public -v2c <ip> .
```
# HTTP
```bash
$ gobuster vhost -u http://localhost -w /opt/SecLists/Discovery/DNS/subdomains-top1million-5000.txt
$ ffuf -u http://localhost -w /opt/SecLists/Discovery/DNS/subdomains-top1million-5000.txt -H 'HOST: FUZZ.domain.com' -fs xxx

```
